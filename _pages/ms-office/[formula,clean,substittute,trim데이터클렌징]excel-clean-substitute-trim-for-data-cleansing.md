---
layout: page
title: 엑셀함수 - CLEAN, SUBSTITUTE, TRIM 함수로 데이터 클렌징
description: 외부 데이터베이스 등에서 엑셀 파일을 받았을 때, 공백, 보이지않는 문자, 와일드카드 우회 등 데이터 클렌징하는 방법
updated: 2024-05-19
---

## 데이터 클렌징이 필요한 경우

간혹 외부에서 받은 데이터에 VLOOKUP 등을 사용할 때 잘 작동하지 않는 경우가 있는데, 보통 아래와 같은 이유 때문이다.

> - 텍스트 형식의 숫자가 사용된 경우
> - 데이터에 *, ?, ~ 와 같은 와일드카드 문자가 사용된 경우
> - 화면에 보이지도 않고, 인쇄도 되지 않는 특수한 문자가 숨겨져 있는 경우
> - 텍스트 앞뒤 또는 사이에 불필요한 공백이 과도하게 삽입되어 있는 경우

## 텍스트 형식의 숫자를 실제 숫자로 또는 반대로 전환

엑셀은 텍스트 형식의 숫자와 실제 숫자를 다른 값으로 취급한다. 즉 `=123`이 입력된 셀과 `="123"`이 입력된 셀은 다른 값이다. 어느 한쪽이든 통일하는 것이 좋다.

- excel - 텍스트 숫자를 실제 숫자로 전환
```excel
=셀 + 0
=셀 * 1
```

두 수식 중 아무거나 하나를 사용하면 된다.

- excel - 실제 숫자를 텍스트 숫자로 전환
```excel
=셀 & ""
=TEXT(셀, "셀서식")
```

두 수식 중 아무거나 하나를 사용하면 된다. 정교한 텍스를 위한 `셀서식` 지정방법은 [MS 오피스 문서](https://support.microsoft.com/ko-kr/office/%ec%88%ab%ec%9e%90-%ec%84%9c%ec%8b%9d%ec%9d%84-%ec%82%ac%ec%9a%a9%ec%9e%90-%ec%a7%80%ec%a0%95%ed%95%98%eb%8a%94-%ec%a7%80%ec%b9%a8-c0a1d1fa-d3f4-4018-96b7-9c9354dd99f5?ui=ko-kr&rs=ko-kr&ad=kr)를 참고하자.

## 클렌징 함수식

```excel
=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TRIM(CLEAN(셀)), "*", "#"), "?", "$"), "~", "^")
```

CLEAN 은 보이지 않는 문자를 제거하고, TRIM 은 불필요한 공백을 제거한다.

와일드카드에 영향을 받는 VLOOKUP 같은 함수를 사용하고자 할 때, 와일드카드 문자를 다른 문자로 치환하여 사용하면 좋다. *, ?, \~ 문자를 각각 #, $, ^ 문자로 바꾼다.

참고로 와일드카드 종류와, 어떤 함수들이 와일드카드에 영향을 받는지는 [이 웹페이지](https://exceljet.net/glossary/wildcard)를 참고하자.