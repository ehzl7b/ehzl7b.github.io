{"name":"msoffice-tips-excel-too-many-cell-formats-message","ver":"[excel,셀서식이너무,2402170818]","cat":"/msoffice-template","pathname":"/post/msoffice-tips-excel-too-many-cell-formats-message","title":"Excel: 셀 서식이 너무 많습니다. 메시지 해결","description":"엑셀에서 셀 서식을 변경하고자 할 때 종종 나오는 '셀 서식이 너무 많습니다.' 메시지를 VBA 매크로를 사용하여 해결하는 방법","updated":"2021-08-16","content":"<article> <h1 id=\"page-title\">Excel: 셀 서식이 너무 많습니다. 메시지 해결</h1><div id=\"page-meta\"><div id=\"page-description\">엑셀에서 셀 서식을 변경하고자 할 때 종종 나오는 '셀 서식이 너무 많습니다.' 메시지를 VBA 매크로를 사용하여 해결하는 방법</div><div id=\"page-updated\">Last updated: 2021-08-16</div></div><div id=\"page-main\"><h2>셀 서식이 너무 많습니다. 메시지</h2>\n<p>엑셀 작업을 하다보면 종종 아래와 같은 짜증나는 팝업 창을 만나는 경우가 있다. 이 메시지가 뜨면 글꼴 변경과 같은 서식 지정이 먹통이 된다.</p>\n<p><img src=\"/img/msoffice/tips/tips-0050.png\" alt=\"그림00\" /></p>\n<p>잘 사용하지는 않지만 엑셀에도 &quot;스타일&quot; 기능이 있는데 위 메시지가 뜨는 경우에는 스타일 안에 뭔가 쓰레기 값이 넘쳐나는 경우가 많다. 구글링을 해보면 이 스타일이 엑셀이 허용하는 한계치(약 6만4천개)를 초과하는 경우 발생하는 에러 메시지로 보인다.</p>\n<h2>VBA 매크로 사용하여 문제 해결</h2>\n<p>먼저 엑셀 파일의 복사본을 미리 만들어둔다. <strong>VBA 매크로의 실행은 되돌리기가 불가능</strong>하기에, 만에하나 있을지 모를 사고를 예방하기 위해서다.</p>\n<p>아래 코드는 매크로를 실행하면 기본으로 내장된 스타일을 제외하고 쓰레기 스타일 값들을 지우는 기능을 한다.</p>\n<ul>\n<li>vba</li>\n</ul>\n<pre><code class=\"language-vb\"><div class=\"codeline \"><span class=\"hljs-keyword\">Sub</span> RemoveStyles()</div><div class=\"codeline \">  <span class=\"hljs-keyword\">Dim</span> li <span class=\"hljs-keyword\">As</span> <span class=\"hljs-type\">Long</span></div><div class=\"codeline \">  <span class=\"hljs-keyword\">On</span> <span class=\"hljs-keyword\">Error</span> <span class=\"hljs-keyword\">Resume</span> <span class=\"hljs-keyword\">Next</span></div><div class=\"codeline \"> </div><div class=\"codeline \">  <span class=\"hljs-keyword\">With</span> ActiveWorkbook</div><div class=\"codeline \">    <span class=\"hljs-keyword\">For</span> li = .Styles.Count <span class=\"hljs-keyword\">To</span> <span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">Step</span> -<span class=\"hljs-number\">1</span></div><div class=\"codeline \">      <span class=\"hljs-keyword\">If</span> <span class=\"hljs-built_in\">Not</span> .Styles(li).BuiltIn <span class=\"hljs-keyword\">Then</span></div><div class=\"codeline \">          .Styles(li).Delete</div><div class=\"codeline \">      <span class=\"hljs-keyword\">End</span> <span class=\"hljs-keyword\">If</span></div><div class=\"codeline \">    <span class=\"hljs-keyword\">Next</span></div><div class=\"codeline \">  <span class=\"hljs-keyword\">End</span> <span class=\"hljs-keyword\">With</span></div><div class=\"codeline \"><span class=\"hljs-keyword\">End</span> <span class=\"hljs-keyword\">Sub</span></div></code></pre>\n<p>매크로를 실행하는데 좀 오래 걸리는데 1~2분 정도 기다리면 된다. 실행이 완료된 후 다시 엑셀로 돌아가면 글꼴이나 색상 변경이 자유로이 되는 것을 확인할 수 있을 것이다.</p>\n</div></article>"}
